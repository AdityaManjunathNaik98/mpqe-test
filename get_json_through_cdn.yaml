name: Get JSON data through CDN
description: Downloads JSON dataset from a CDN URL and saves it.
inputs:
  - name: process_json_url
    type: String
    description: URL to fetch the JSON dataset from.
outputs:
  - name: input_json_file  # Changed from processed_data to match the next component's input
    type: String
implementation:
  container:
    image: python:3.9
    command:
      - sh
      - -c
      - |
        set -e
        python3 -m pip install --quiet requests

        exec "$0" "$@"
      - python3
      - -u
      - -c
      - |
        import argparse, os, requests, json

        parser = argparse.ArgumentParser()
        parser.add_argument('--process_json_url', type=str, required=True)
        parser.add_argument('--input_json_file', type=str, required=True)  # Changed from processed_data
        args = parser.parse_args()

        # args.process_json_url = args.process_json_url.replace("$$", "$$$")
        # args.weights_url = args.weights_url.replace("$$", "$$$")


        # --- Step 1: Download JSON from CDN ---
        print(f"Fetching JSON from CDN: {args.process_json_url}")
        resp = requests.get(args.process_json_url)
        resp.raise_for_status()

        os.makedirs(os.path.dirname(args.input_json_file), exist_ok=True)  # Changed variable name
        with open(args.input_json_file, "wb") as f:  # Changed variable name
            f.write(resp.content)
        print(f"Dataset saved at {args.input_json_file}")  # Changed variable name

    args:
      - --process_json_url
      - { inputValue: process_json_url }
      - --json_file  # Changed from input_json_file
      - { outputPath: json_file }  # Changed from input_json_file